<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Th·ªëng k√™ - Admin Dashboard</title>
<link
	th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css}"
	rel="stylesheet">
<link
	th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css}"
	rel="stylesheet">
<style>
body {
	font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
	background-color: #f8f9fa;
	margin: 0;
	display: flex;
}
/* Sidebar */
.sidebar {
	width: 250px;
	background: linear-gradient(180deg, #198754 0%, #157347 100%);
	color: #fff;
	height: 100vh;
	position: fixed;
	padding-top: 1rem;
	display: flex;
	flex-direction: column;
}

.sidebar .navbar-brand img {
	max-height: 55px;
	margin-bottom: 20px;
	border-radius: 10px;
}

.sidebar .nav-link {
	font-weight: 500;
	color: #e9ecef;
	padding: 12px 18px;
	display: flex;
	align-items: center;
	border-radius: 8px;
	margin: 4px 8px;
	transition: 0.25s;
}

.sidebar .nav-link:hover, .sidebar .nav-link.active {
	background-color: #fff;
	color: #198754;
	font-weight: 600;
}

.sidebar .nav-link i {
	margin-right: 10px;
	font-size: 1.1rem;
}
/* Content */
.content {
	margin-left: 250px;
	padding: 20px;
	flex: 1;
}

.topbar {
	background-color: #fff;
	padding: 12px 20px;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
	margin-bottom: 20px;
	display: flex;
	justify-content: space-between;
	align-items: center;
	border-radius: 0.75rem;
}

.card {
	border-radius: 0.75rem;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
	border: none;
}

.card-header {
	font-weight: 600;
	font-size: 0.95rem;
	border-radius: 0.75rem 0.75rem 0 0;
}

.stats-number {
	font-size: 1.25rem;
	font-weight: bold;
	color: #0d6efd;
}

.dropdown .btn-secondary {
	background-color: #198754;
	border: none;
	font-weight: 500;
	padding: 6px 14px;
	border-radius: 8px;
}

.dropdown .btn-secondary:hover {
	background-color: #145c32;
}

.logo-container {
	display: flex;
	justify-content: center;
	align-items: center;
	margin-bottom: 25px;
	padding: 15px;
}

.logo-img {
	width: 120px;
	height: auto;
	border-radius: 12px;
	object-fit: cover;
	transition: transform 0.3s ease;
}

.logo-img:hover {
	transform: scale(1.1);
}
/* Dropdown Topbar */
.topbar .dropdown-toggle::after {
	margin-left: 0.3rem;
}

.table-sm th, .table-sm td {
	vertical-align: middle;
}
</style>
</head>
<body>

	<!-- Sidebar -->
	<div class="sidebar">
		<a th:href="@{/}"
			class="navbar-brand text-center d-block logo-container"> <img
			th:src="@{/img/logo.png}" alt="F6Shop" class="logo-img">
		</a>
		<ul class="nav flex-column mt-3">
			<li class="nav-item"><a class="nav-link"
				th:href="@{/admin/index}"><i class="fas fa-home"></i> Trang ch·ªß</a></li>
			<li class="nav-item"><a class="nav-link"
				th:href="@{/admin/category/list}"><i class="fas fa-list"></i>
					Lo·∫°i s·∫£n ph·∫©m</a></li>
			<li class="nav-item"><a class="nav-link"
				th:href="@{/admin/product/list/1}"><i class="fas fa-box"></i>
					S·∫£n ph·∫©m</a></li>
			<li class="nav-item"><a class="nav-link"
				th:href="@{/admin/account/list/1}"><i
					class="fa-solid fa-circle-user"></i> Ng∆∞·ªùi d√πng</a></li>
			<li class="nav-item"><a class="nav-link"
				th:href="@{/admin/order}"><i class="fas fa-file-invoice-dollar"></i>
					H√≥a ƒë∆°n</a></li>
			<li class="nav-item"><a class="nav-link"
				th:href="@{/admin/news}"><i class="fas fa-newspaper"></i> Tin
					t·ª©c</a></li>
			<li class="nav-item"><a class="nav-link"
				data-bs-toggle="collapse" href="#collapseThongKe" role="button"
				aria-expanded="false" aria-controls="collapseThongKe"> <i
					class="fas fa-chart-line"></i> Th·ªëng k√™
			</a>
				<div class="collapse" id="collapseThongKe">
					<ul class="nav flex-column ms-3">
						<li class="nav-item"><a class="nav-link"
							th:href="@{/admin/doanhthu}"> <i class="fas fa-coins"></i>
								Doanh thu
						</a></li>
						<li class="nav-item"><a class="nav-link"
							th:href="@{/admin/donhang}"> <i class="fas fa-shopping-cart"></i>
								ƒê∆°n h√†ng
						</a></li>
						<li class="nav-item"><a class="nav-link"
							th:href="@{/admin/sanpham}"> <i class="fas fa-boxes"></i> S·∫£n
								ph·∫©m
						</a></li>
					</ul>
				</div></li>

		</ul>

		<div class="mt-auto p-3">
			<div class="dropdown text-center">
				<span class="btn btn-secondary dropdown-toggle w-100"
					id="loggedInUserDropdown" data-bs-toggle="dropdown"
					aria-expanded="false" th:text="${session.fullName}"></span>
				<ul class="dropdown-menu" aria-labelledby="loggedInUserDropdown">
					<li><a class="dropdown-item" th:href="@{/logout}">ƒêƒÉng
							Xu·∫•t</a></li>
				</ul>
			</div>
		</div>
	</div>

	<!-- Content -->
	<div class="content">
		<!-- Topbar -->
		<div class="topbar">
			<h5 class="mb-0 fw-bold text-success">üìä B√°o c√°o th·ªëng k√™ ƒë∆°n h√†ng</h5>
		</div>
		<!-- Danh s√°ch ƒë∆°n h√†ng -->
		<div class="row g-4">

				<h2>üì¶ ƒê∆°n h√†ng theo tr·∫°ng th√°i</h2>
				<table class="table">
					<thead>
						<tr>
							<th>Tr·∫°ng th√°i</th>
							<th>S·ªë l∆∞·ª£ng</th>
						</tr>
					</thead>
					<tr th:each="row : ${data}">
						<td th:switch="${row[0]}">
							<span th:case="1">Ch·ªù x√°c nh·∫≠n</span>
							<span th:case="2">ƒê√£ x√°c nh·∫≠n</span>
							<span th:case="3">ƒêang giao</span>
							<span th:case="4">Ho√†n th√†nh</span>
							<span th:case="5">ƒê√£ h·ªßy</span>
							<span th:case="*">Kh√¥ng x√°c ƒë·ªãnh</span>
						</td>
						<td th:text="${row[1]}"></td>
					</tr>

				</table>

			

			<!-- Th·ªëng k√™ theo kho·∫£ng ng√†y -->
			<div class="col-12">
				<div class="card shadow-sm">
					<div class="card-header bg-primary text-white fw-semibold">
						<i class="fas fa-calendar-alt me-1"></i> Th·ªëng k√™ ƒë∆°n h√†ng trong
						kho·∫£ng ng√†y
					</div>
					<div class="card-body">
						<!-- Form ch·ªçn kho·∫£ng ng√†y -->
						<form th:action="@{/admin/donhang}" method="get"
							class="row g-3 mb-3">
							<div class="col-md-4">
								<label for="startDate" class="form-label">T·ª´ ng√†y:</label> <input
									type="date" id="startDate" name="startDate"
									class="form-control form-control-sm" th:value="${startDate}" />
							</div>
							<div class="col-md-4">
								<label for="endDate" class="form-label">ƒê·∫øn ng√†y:</label> <input
									type="date" id="endDate" name="endDate"
									class="form-control form-control-sm" th:value="${endDate}" />
							</div>
							<button type="submit" class="btn btn-primary btn-sm px-3">
								<i class="fas fa-chart-bar me-1"></i> Th·ªëng k√™
							</button>

						</form>

						<!-- Hi·ªÉn th·ªã l·ªói n·∫øu ng√†y sai -->
						<div th:if="${error != null}" class="alert alert-danger"
							th:text="${error}"></div>

						<!-- Hi·ªÉn th·ªã k·∫øt qu·∫£ khi c√≥ d·ªØ li·ªáu -->
						<div th:if="${orderCountBetween != null}">
							<p>
								<strong>T·ªïng s·ªë ƒë∆°n:</strong> <span
									th:text="${orderCountBetween}"></span>
							</p>
							<p>
								<strong>Doanh thu:</strong> <span
									th:text="${#numbers.formatDecimal(revenueBetween,0,'COMMA',0,'POINT')} + ' VNƒê'"></span>
							</p>

							<h6 class="mt-3 mb-2 fw-bold">üìÖ Chi ti·∫øt theo t·ª´ng ng√†y:</h6>
							<table class="table table-bordered text-center table-sm">
								<thead class="table-light">
									<tr>
										<th class="rounded-start">Ng√†y</th>
										<th class="rounded-end">S·ªë ƒë∆°n</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="row : ${ordersPerDay}">
										<td th:text="${row[0]}"></td>
										<td th:text="${row[1]}"></td>
									</tr>
									<tr
										th:if="${ordersPerDay == null or #lists.isEmpty(ordersPerDay)}">
										<td colspan="2" class="text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu.</td>
									</tr>
								</tbody>
							</table>
						</div>

						<!-- Th√¥ng b√°o khi ch∆∞a ch·ªçn ng√†y -->
						<div th:if="${orderCountBetween == null and error == null}"
							class="text-muted fst-italic">Vui l√≤ng ch·ªçn kho·∫£ng ng√†y ƒë·ªÉ
							xem th·ªëng k√™.</div>
					</div>
				</div>
			</div>
		
			<!-- T·ªïng ƒë∆°n h√†ng -->
			<div class="col-12">
				<div class="card shadow-sm">
					<div class="card-header bg-warning text-white fw-semibold">
						<i class="fas fa-file-invoice-dollar me-1"></i> T·ªïng ƒë∆°n h√†ng
					</div>
					<div class="card-body p-2">
						<div class="table-responsive">
							<table
								class="table table-striped table-hover table-sm text-center mb-0">
								<thead class="table-light">
									<tr>
										<th class="rounded-start">M√£ ƒë∆°n h√†ng</th>
										<th>T√™n kh√°ch</th>
										<th>T·ªïng s·ªë l∆∞·ª£ng</th>
										<th class="rounded-end">T·ªïng ti·ªÅn</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="order : ${orderSummaries}">
										<td th:text="${order[0]}"></td>
										<td th:text="${order[1]}"></td>
										<td th:text="${order[2]}"></td>
										<td
											th:text="${#numbers.formatDecimal(order[3],0,'COMMA',0,'POINT')} + ' VNƒê'"></td>
									</tr>
									<tr
										th:if="${orderSummaries == null or #lists.isEmpty(orderSummaries)}">
										<td colspan="4" class="text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu.</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>

		</div>





	</div>

	<!-- Error -->
	<div th:if="${error}" class="alert alert-danger mt-4 text-center"
		th:text="${error}"></div>

	</div>

	<script
		th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js}"></script>
</body>
</html>
